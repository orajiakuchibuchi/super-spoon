<div class="container-fluid">
  <div class="row">
    <div class="col-md-12">
      <div class="panel panel-primary card" *ngIf="start && !ringing">
        <div class="panel-heading card-header" id="accordion">
          <span class="glyphicon glyphicon-comment"></span>
          <strong>Live Chat</strong>
          <div class="btn-group pull-right">
            <a
              type="button"
              class="btn btn-default btn-xs bloxing"
              data-toggle="collapse"
              data-parent="#accordion"
              href="#collapseOne"
              (click)="showing = !showing"
            >
              <i class="icon-copy bi bi-caret-down-fill" *ngIf="showing"></i>
              <i class="icon-copy bi bi-caret-up-fill" *ngIf="!showing"></i>
            </a>
          </div>
        </div>
        <div class="panel-collapse collapse card-body" id="collapseOne">
          <div class="panel-body">
            <ul class="chat">
              <li class="left clearfix" [ngClass]="{'right': convo.sender == 'Customer','left': convo.sender !== 'Customer'}" *ngFor="let convo of conversation">
                <span class="chat-img pull-left">
                  <img
                    src="{{convo.sender !== 'Customer' ? 'assets/img/gallery/unnamed.jpg': 'http://placehold.it/50/55C1E7/fff&text=U'}}"

                    height="40"
                    alt="User Avatar"
                    class="img-circle"
                  />
                </span>
                <div class="chat-body clearfix">
                  <div class="header">
                    <strong class="primary-font">{{convo.sender}}</strong>
                    <small class="text-muted" [ngClass]="{'pull-right': convo.sender !== 'Customer'}">
                      <span class="glyphicon glyphicon-time"></span>{{getReadableTime(convo.at) | slice:0:9}}</small
                    >
                  </div>
                  <p>
                    {{convo.message}}
                  </p>
                </div>
              </li>
            </ul>
          </div>
          <div class="panel-footer">
            <div class="input-group">
              <input
                id="btn-input"
                type="text"
                readonly
                class="form-control input-sm"
                placeholder="Type your message here..."
              />
              <span class="input-group-btn">
                <button class="btn btn-warning btn-sm" id="btn-chat">
                  Send
                </button>
              </span>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12 text-center" *ngIf="ringing">
          <p class="blink_me">
            Thank you for your patience. Our team is currently experiencing
            higher volumes, but rest assured, we'll be with you shortly. Your
            query is important to us, and we're working diligently to connect
            you with the right agent. Thank you for your understanding.
          </p>
        </div>
        <div class="col-md-12 text-center" *ngIf="!start && !ringing">
          <form>
            <div class="form-group">
              <label for="nameOfVisitor">Name</label>
              <input
                type="text"
                class="form-control"
                name="nameOfVisitor"
                [(ngModel)]="name"
                id="nameOfVisitor"
                placeholder="Name"
              />
            </div>
            <div class="form-group">
              <label for="visitorEmail">Email</label>
              <input
                type="email"
                class="form-control"
                name="visitorEmail"
                [(ngModel)]="email"
                id="visitorEmail"
                aria-describedby="emailHelp"
                placeholder="Enter email"
              />
              <small id="emailHelp" class="form-text text-muted">{{
                message
              }}</small>
            </div>
            <button class="btn btn-sm btn-success mr-2" (click)="startSession()">
              Start Session
            </button>
            <button class="btn btn-sm btn-danger" (click)="endSession()">
              Close
            </button>
          </form>
        </div>
        <div class="col-md-12 text-center" *ngIf="start">
          <button class="btn btn-sm btn-danger" (click)="endSession()">
            End Session
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
